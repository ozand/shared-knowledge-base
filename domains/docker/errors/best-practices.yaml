title: Docker Best Practices and Common Issues
scope: docker
severity: medium
category: docker-errors
last_updated: "2026-01-08"
tags:
- docker
- best-practices
- configuration
- production
errors:
- id: DOCKER-024
  title: Healthcheck Command Not Available in Container Image
  severity: medium
  scope: docker
  problem: 'Healthcheck configured to use a command that doesn''t exist in the container
    image

    (e.g., curl in minimal Python images). Container shows unhealthy even though

    application is working correctly.


    **Common Issue:** Minimal images (python:slim, alpine) don''t include external
    tools like curl.

    '
  wrong_code: "services:\n  notebooklm-mindmap:\n    image: python:3.11-slim  # Minimal\
    \ image without curl\n    healthcheck:\n      test: [\"CMD-SHELL\", \"curl --fail\
    \ http://localhost:8501/_stcore/health\"]\n      # Result: /bin/sh: 1: curl: not\
    \ found\n"
  correct_code: "services:\n  notebooklm-mindmap:\n    image: python:3.11-slim\n \
    \   healthcheck:\n      test: [\"CMD-SHELL\", \"python -c \\\"import urllib.request;\
    \ urllib.request.urlopen('http://localhost:8501/_stcore/health').read()\\\"\"\
    ]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period:\
    \ 40s\n      # Result: Uses Python's built-in urllib library\n"
  solution_steps: "1. Check container logs for healthcheck errors: docker logs CONTAINER\n\
    2. Verify if command exists in image: docker run --rm IMAGE which curl\n3. Find\
    \ alternatives available in the base image:\n   - Python images: Use python -c\
    \ \"import urllib.request; ...\"\n   - Node.js images: Use node -e \"require('http').get('http://localhost:PORT/health')\"\
    \n   - Bash: Use /dev/tcp/HOST/PORT if bash available\n   - Always use built-in\
    \ tools when possible\n4. Update healthcheck in docker-compose.yml\n5. Recreate\
    \ container: docker-compose up -d\n6. Verify: docker ps --format \"table {{.Names}}\\\
    t{{.Status}}\"\n"
  prevention_steps: "1. Always verify commands exist in base image before using in\
    \ healthcheck\n2. Test healthcheck command locally: docker run --rm IMAGE <command>\n\
    3. Prefer built-in language libraries over external tools\n4. Common alternatives:\n\
    \   - curl/wget → python urllib, node http, java net\n   - nc/netcat → bash /dev/tcp/...\
    \ (if bash available)\n   - grep/sed → python string methods, node string methods\n\
    5. Read image documentation for available tools\n"
  tags:
  - docker
  - healthcheck
  - minimal-images
  - curl
  - python
  - best-practices
  domains:
    primary: docker
    secondary: []
