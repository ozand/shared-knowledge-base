title: File System and Organization Management
scope: universal
severity: low
category: best-practices
last_updated: "2026-01-08"
tags:
- filesystem
- organization
- monitoring
- automation
patterns:
- id: UNIVERSAL-006
  title: Broken Symlink Detection and Prevention
  severity: medium
  scope: universal
  problem: "Symbolic links (symlinks) with typos in target paths create broken links\
    \ that:\n- Don't point to valid locations\n- Cause confusion when troubleshooting\n\
    - Lead to \"No such file or directory\" errors\n- Create maintenance issues\n\n\
    **Common Causes:**\n- Typos in symlink target path\n- Target directory moved or\
    \ deleted\n- Case sensitivity issues (bolt.diy vs bolt.dyi)\n- Relative vs absolute\
    \ path confusion\n\n**Example from Session:**\n```bash\n/home/ozand/bolt.diy ->\
    \ /home/ozand/projects/docker-deployments/bolt.dyi\n                         \
    \                                                     ^^^^^^^^^^^\n          \
    \                                                                   TYPO! Should\
    \ be bolt.diy\n```\n"
  solution: "**1. Detection Commands:**\n\nFind all broken symlinks:\n```bash\n# Find\
    \ broken symlinks in directory\nfind /path/to/dir -xtype l\n\n# Find broken symlinks\
    \ showing target\nfind /path/to/dir -xtype l -exec ls -l {} \\;\n\n# Check if\
    \ symlink target exists\nif [ -e /path/to/symlink ]; then\n  echo \"OK\"\nelse\n\
    \  echo \"BROKEN\"\nfi\n```\n\n**2. Prevention When Creating Symlinks:**\n\nAlways\
    \ verify target exists first:\n```bash\n# ‚úÖ CORRECT: Verify target exists\nif\
    \ [ -d /home/ozand/projects/docker-deployments/bolt.diy ]; then\n  ln -s /home/ozand/projects/docker-deployments/bolt.dyi\
    \ \\\n        /home/ozand/bolt.diy\nelse\n  echo \"ERROR: Target does not exist!\"\
    \nfi\n\n# ‚ùå WRONG: Create without verification\nln -s /home/ozand/projects/docker-deployments/bolt.dyi\
    \ \\\n      /home/ozand/bolt.diy\n# Result: Broken symlink if target has typo\n\
    ```\n\n**3. Fixing Broken Symlinks:**\n\n```bash\n# Remove broken symlink\nrm\
    \ /path/to/broken/symlink\n\n# Recreate with correct target\nln -s /correct/target/path\
    \ /path/to/symlink\n```\n\n**4. Best Practices:**\n\n- Use absolute paths for\
    \ symlinks to avoid confusion\n- Double-check target path spelling\n- Verify target\
    \ exists before creating symlink\n- Test symlink immediately after creation\n\
    - Remove symlinks when target is permanently moved\n\n**5. Automated Detection:**\n\
    \nAdd to cron for weekly checks:\n```bash\n# Weekly broken symlink scan\n0 3 *\
    \ * 0 find /home/ozand -xtype l >> /home/ozand/backups/symlink-check.log\n```\n"
  diagnosis_steps: "1. List all symlinks:\n   ```bash\n   find /home/ozand -maxdepth\
    \ 1 -type l\n   ```\n\n2. Check each symlink target:\n   ```bash\n   for link\
    \ in $(find /home/ozand -maxdepth 1 -type l); do\n     echo \"$link -> $(readlink\
    \ $link)\"\n     if [ -e \"$link\" ]; then\n       echo \"  ‚úÖ OK\"\n     else\n\
    \       echo \"  ‚ùå BROKEN\"\n     fi\n   done\n   ```\n\n3. Find broken symlinks\
    \ only:\n   ```bash\n   find /home/ozand -xtype l -ls\n   ```\n\n4. Show symlink\
    \ details:\n   ```bash\n   ls -la /path/to/symlink\n   stat /path/to/symlink\n\
    \   readlink /path/to/symlink\n   ```\n\n5. Check specific symlink:\n   ```bash\n\
    \   test -e /path/to/symlink && echo \"OK\" || echo \"BROKEN\"\n   ```\n"
  benefits:
  - Prevents "file not found" errors
  - Cleaner filesystem (no broken links)
  - Easier troubleshooting
  - Better organization
  tags:
  - symlink
  - filesystem
  - troubleshooting
  - organization
  related_entries:
  - UNIVERSAL-001
- id: UNIVERSAL-007
  title: Root Directory Temporary File Management
  severity: medium
  scope: universal
  problem: 'Temporary files (backups, archives, downloads) accumulating in root directory

    violate Golden Rules and create:

    - Clutter in home directory

    - Large files wasting space (8 GB backups in root)

    - Difficulty finding files when needed

    - Violation of organizational standards


    **Common Violators:**

    - `*_backup_*.tar.gz` files (should be in /backups/)

    - `*.zip`, `*.tar.gz` archives (should be in /archives/)

    - `*.iso`, `*.dmg` download files (should be in Downloads/)

    - Temporary build artifacts (should be in /tmp/)


    **Real Example:**

    ```bash

    $ ls -lh /home/ozand/*.tar.gz

    -rw-rw-r-- 1 ozand ozand 8.0G Jan 4 21:50 organization_backup_20260104_213329.tar.gz

    -rw-rw-r-- 1 ozand ozand  13K Jan 4 22:38 supabase_backup_20260104_223819.tar.gz

    ```

    '
  solution: '**1. Golden Rules Policy:**


    **Root Directory Rules:**

    - ‚ùå NO temporary files (.tar.gz, .zip, etc.)

    - ‚ùå NO backup files (*_backup_*.tar.gz)

    - ‚ùå NO download files (.iso, .dmg, .exe)

    - ‚úÖ Config files allowed (.env, .yaml, .md)


    **File Type Locations:**

    - üì¶ **Backups:** `/backups/<project>/<filename>.tar.gz`

    - üóÑÔ∏è **Archives:** `/archives/<category>/<filename>.tar.gz`

    - ‚è≥ **Temporary:** `/tmp/` (cleared on reboot)

    - üì• **Downloads:** `~/Downloads/` (XDG standard)


    **2. Manual Cleanup:**


    ```bash

    # Move backups to correct location

    mv /home/ozand/*backup*.tar.gz /home/ozand/backups/tmp/


    # Move archives

    mv /home/ozand/*.tar.gz /home/ozand/archives/


    # Verify root is clean

    ls -lh /home/ozand/*.tar.gz

    # Should return: "No such file or directory"

    ```


    **3. Organizational Structure:**


    ```

    /home/ozand/

    ‚îú‚îÄ‚îÄ backups/

    ‚îÇ   ‚îú‚îÄ‚îÄ organization/         # Large backups (8GB+)

    ‚îÇ   ‚îú‚îÄ‚îÄ supabase/             # Database backups

    ‚îÇ   ‚îú‚îÄ‚îÄ docker/               # Docker volume backups

    ‚îÇ   ‚îî‚îÄ‚îÄ tmp/                  # Staging area before deletion

    ‚îú‚îÄ‚îÄ archives/

    ‚îÇ   ‚îú‚îÄ‚îÄ old-projects/         # Archived project code

    ‚îÇ   ‚îú‚îÄ‚îÄ configs/              # Old configuration files

    ‚îÇ   ‚îî‚îÄ‚îÄ logs/                 # Compressed logs

    ‚îî‚îÄ‚îÄ [no files in root!]

    ```


    **4. Backup Script Standards:**


    Always configure backup scripts to use correct paths:

    ```bash

    # ‚úÖ CORRECT:

    BACKUP_DIR="/home/ozand/backups/$(date +%Y-%m-%d)"

    mkdir -p "$BACKUP_DIR"

    tar -czf "$BACKUP_DIR/backup.tar.gz" /path/to/source


    # ‚ùå WRONG:

    tar -czf /home/ozand/backup_$(date +%Y%m%d).tar.gz /path/to/source

    ```


    **5. Automated Monitoring:**


    See UNIVERSAL-008 for monitoring setup.

    '
  diagnosis_steps: "1. Check for temporary files in root:\n   ```bash\n   ls -lh /home/ozand/*.tar.gz\
    \ /home/ozand/*.zip 2>/dev/null\n   ```\n\n2. Find large files in root:\n   ```bash\n\
    \   find /home/ozand -maxdepth 1 -type f -size +100M -exec ls -lh {} \\;\n   ```\n\
    \n3. Categorize files by type:\n   ```bash\n   # Backups\n   ls /home/ozand/*backup*\n\
    \n   # Archives\n   ls /home/ozand/*.tar.gz\n\n   # All temporary files\n   find\
    \ /home/ozand -maxdepth 1 \\( -name \"*.tar.gz\" -o -name \"*.zip\" -o -name \"\
    *.iso\" \\)\n   ```\n\n4. Check file ages:\n   ```bash\n   find /home/ozand -maxdepth\
    \ 1 -type f -mtime +7 -ls\n   ```\n\n5. Verify correct locations:\n   ```bash\n\
    \   # Are files in /backups/?\n   ls /home/ozand/backups/\n\n   # Are files in\
    \ /archives/?\n   ls /home/ozand/archives/\n   ```\n"
  benefits:
  - Clean root directory (100% Golden Rules compliant)
  - Organized backup storage
  - Easy to find files when needed
  - Automated monitoring prevents accumulation
  tags:
  - file-organization
  - backup
  - golden-rules
  - cleanup
  related_entries:
  - UNIVERSAL-001
  - UNIVERSAL-008
- id: UNIVERSAL-008
  title: Automated Monitoring Without Auto-Deletion
  severity: low
  scope: universal
  problem: 'Need to monitor root directory for temporary files accumulation, but

    auto-deletion is too dangerous (can delete important files accidentally).


    **Challenges:**

    - Need to detect violations automatically

    - Should NOT auto-delete (safety first)

    - Must notify admin when issues found

    - Should provide actionable information

    - Requires minimal manual intervention


    **Admin Philosophy:**

    Monitor ‚Üí Notify ‚Üí Manual Review ‚Üí Action

    (NOT: Monitor ‚Üí Auto-Delete ‚Üí Regret)

    '
  solution: "**1. Two-Script Approach:**\n\n**Lightweight Notification Script** (for\
    \ cron):\n```bash\n#!/bin/bash\n# /home/ozand/tools/cleanup-root-notify.sh\n\n\
    ROOT_DIR=\"/home/ozand\"\nPATTERNS=(\"*.tar.gz\" \"*.zip\" \"*backup*\")\n\nFOUND=0\n\
    for pattern in \"${PATTERNS[@]}\"; do\n  COUNT=$(find \"$ROOT_DIR\" -maxdepth\
    \ 1 -name \"$pattern\" -type f 2>/dev/null | wc -l)\n  FOUND=$((FOUND + COUNT))\n\
    done\n\nif [ $FOUND -gt 0 ]; then\n  # Create notification\n  echo \"Found $FOUND\
    \ file(s) in root\" >> /home/ozand/backups/cleanup.log\n\n  # Desktop notification\
    \ if logged in\n  [ -n \"$DISPLAY\" ] && notify-send \"Root Cleanup\" \"$FOUND\
    \ files in $ROOT_DIR\" || true\nfi\n```\n\n**Interactive Cleanup Script** (manual\
    \ use):\n```bash\n#!/bin/bash\n# /home/ozand/tools/cleanup-root-monitor.sh\n\n\
    # Scan for files\nFOUND_FILES=()\nfor pattern in \"${PATTERNS[@]}\"; do\n  while\
    \ IFS= read -r -d '' file; do\n    FOUND_FILES+=(\"$file\")\n  done < <(find \"\
    $ROOT_DIR\" -maxdepth 1 -name \"$pattern\" -type f -print0 2>/dev/null)\ndone\n\
    \n# Show details\nfor file in \"${FOUND_FILES[@]}\"; do\n  SIZE=$(du -h \"$file\"\
    \ | cut -f1)\n  echo \"  ‚Ä¢ $(basename \"$file\") (${SIZE})\"\ndone\n\n# Offer\
    \ options\necho \"Choose action:\"\necho \"  1. Show manual commands to run\"\n\
    echo \"  2. Move all to /backups/tmp/ for review\"\necho \"  3. Skip\"\n\nread\
    \ -p \"Choose [1/2/3]: \" choice\n\ncase $choice in\n  1) echo \"Commands to run\
    \ manually:\"; for f in \"${FOUND_FILES[@]}\"; do echo \"mv \\\"$f\\\" /backups/tmp/\"\
    ; done ;;\n  2) mkdir -p /home/ozand/backups/tmp; for f in \"${FOUND_FILES[@]}\"\
    ; do mv \"$f\" /home/ozand/backups/tmp/; done ;;\n  3) echo \"Skipped\"; ;;\n\
    esac\n```\n\n**2. Cron Configuration:**\n\n```bash\n# Daily check at 9:00 AM\n\
    0 9 * * * /home/ozand/tools/cleanup-root-notify.sh\n\n# Optional: Weekly full\
    \ scan report\n0 10 * * 0 /home/ozand/tools/cleanup-root-monitor.sh >> /home/ozand/backups/weekly-report.log\n\
    ```\n\n**3. Safety Features:**\n\n- ‚úÖ Never auto-deletes\n- ‚úÖ Always requires\
    \ human confirmation\n- ‚úÖ Shows file details before action\n- ‚úÖ Logs all actions\n\
    - ‚úÖ Move to /tmp staging area first\n- ‚úÖ Can skip if not sure\n\n**4. Logging:**\n\
    \n```bash\n# Log format\n[2026-01-05 09:00:00] Found 3 files in root\n[2026-01-05\
    \ 09:05:00] User chose option 2\n[2026-01-05 09:05:30] Moved 3 files to /backups/tmp/\n\
    ```\n\n**5. Benefits of This Approach:**\n\n- **Safe**: No accidental deletions\n\
    - **Educational**: See patterns over time\n- **Flexible**: Choose action each\
    \ time\n- **Auditable**: Full log history\n- **Reversible**: Can undo from /tmp\n"
  benefits:
  - Automated detection without risks
  - Admin stays in control
  - Learn patterns over time
  - Fix root causes (e.g., backup scripts)
  - Peaceful night's sleep (no auto-deletion anxiety)
  tags:
  - automation
  - monitoring
  - safety
  - cron
  related_entries:
  - UNIVERSAL-007
  - UNIVERSAL-001
  domains:
    primary: monitoring
    secondary: []
