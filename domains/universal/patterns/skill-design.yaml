# Skill Design Pattern
# Best practices for designing Claude Code SKILL.md files

version: "1.0"
category: "claude-code"
last_updated: "2026-01-07"

patterns:
  - id: "SKILL-DESIGN-001"
    title: "Claude Code Skill Design Best Practices"
    severity: "high"
    scope: "universal"
    tags: ["claude-code", "skills", "design", "yaml", "best-practices", "documentation"]

    problem: |
      Poorly designed SKILL.md files lead to:
      - Skills never triggering when needed
      - Skills triggering incorrectly (false positives)
      - Excessive token usage (too much content loaded)
      - Difficult maintenance (monolithic files)
      - Claude not understanding when to use the skill

      **Symptoms:**
      - Skill with vague description: "Testing helper" (never triggers)
      - SKILL.md with 2000+ lines (loads too much, slow)
      - 10 micro-skills for testing (confusing, scattered)
      - Scripts without error handling (mysterious failures)
      - Deep nested references (@ref1 → @ref2 → @ref3)

    impact: |
      - **Skill trigger accuracy:** Poor description = 0% trigger rate
      - **Token efficiency:** 2000-line SKILL.md wastes 1500+ tokens per use
      - **Maintenance:** Monolithic files are hard to update
      - **User experience:** Skills don't work when expected
      - **Team adoption:** Confusing skill structure prevents sharing

    solution: |
      **Skill Design Principles:**

      1. **Evaluation-Driven Development**: Start with gap analysis, not assumptions
      2. **Clear, Specific Descriptions**: Description = 80% of success
      3. **Progressive Disclosure**: Keep SKILL.md lean, use @resources/
      4. **Consolidation**: One comprehensive skill > 10 micro-skills
      5. **Error Handling**: Scripts must fail gracefully with helpful messages

    implementation: "@references/SKILL-DESIGN-001-implementation.md"

    best_practices:
      - practice: "Use evaluation-driven development"
        guideline: "Define gap → Create evaluations → Write minimal skill → Test with Claude B"
        reason: "Observations > Assumptions. Skills based on real usage work better."

      - practice: "Write crystal-clear descriptions"
        guideline: "Spend 80% of time on description. Explain WHEN to use, not WHAT."
        reason: "Description determines when skill triggers. Vague = never triggers."

      - practice: "Keep SKILL.md lean"
        guideline: "200-500 lines max. Move details to resources/ with @references."
        reason: "Faster loading, less tokens, easier maintenance."

      - practice: "Consolidate related skills"
        guideline: "One skill for testing, not 10 micro-skills (unit, integration, e2e...)"
        reason: "Less confusion, easier for Claude to choose, less metadata overhead."

      - practice: "Add error handling to scripts"
        guideline: "Scripts MUST NOT crash. Return helpful error messages."
        reason: "Claude needs to know what went wrong to help user."

      - practice: "Use specific descriptions"
        guideline: |
          BAD: "Code review"
          GOOD: "Reviews PRs for security and performance issues"
        reason: "Specific descriptions prevent false positives."

      - practice: "Test with fresh Claude instance"
        guideline: "Use Claude A to build, Claude B to test. Never test in isolation."
        reason: "Real usage reveals problems that theoretical testing misses."

      - practice: "Version your skills"
        guideline: "Use semantic versioning: 1.0.0 → 1.0.1 (bugs), 1.1.0 (features), 2.0.0 (breaking)"
        reason: "Track changes, enable rollbacks, communicate impact."

    anti_patterns: "@references/SKILL-DESIGN-001-anti-patterns.md"

    real_world_examples: "@references/SKILL-DESIGN-001-examples.md"

    verification:
      trigger_check:
        test: "Verify skill description triggers correctly"
        method: |
          1. Start new Claude Code session with skill loaded
          2. Ask: "Did you load {skill-name}?"
          3. If NO: Description needs to be more specific
          4. If YES: Skill is discoverable

      size_check:
        test: "Verify SKILL.md is not too large"
        method: |
          wc -l .claude/skills/{skill-name}/SKILL.md
          # Should be < 500 lines
          # Ideally 200-400 lines

      reference_check:
        test: "Verify all @references resolve"
        method: |
          # Extract all @references from SKILL.md
          grep -oh "@[a-zA-Z/_-]*\.md" \
            .claude/skills/{skill-name}/SKILL.md

          # Verify each file exists
          for ref in $(grep -oh "@[a-zA-Z/_-]*\.md" \
            .claude/skills/{skill-name}/SKILL.md); do
            file="${ref#@}"
            if [ ! -f ".claude/skills/{skill-name}/$file" ]; then
              echo "❌ Broken reference: $ref"
            fi
          done

      evaluation_check:
        test: "Verify skill improves performance"
        method: |
          1. Create 3 evaluation scenarios
          2. Run WITHOUT skill → Record baseline scores
          3. Run WITH skill → Record new scores
          4. Compare: improvement = new - baseline
          5. If no improvement: Refine skill

    testing_checklist:
      design_phase:
        - "Problem clearly defined (gap analysis done)"
        - "3 evaluation scenarios created"
        - "Baseline score obtained (without skill)"
        - "Skill written (≤500 lines SKILL.md)"
        - "Resources organized in subdirectories"

      quality_checks:
        - "YAML frontmatter is valid"
        - "Description is specific & clear"
        - "Name is lowercase-kebab-case"
        - "Instructions are sequential & clear"
        - "Examples are minimal (1-2 per pattern)"
        - "Error handling in scripts"
        - "No circular references"

      testing_phase:
        - "Tested with fresh Claude instance"
        - "All 3 evaluations run successfully"
        - "Score improvement measured"
        - "Iteratively improved based on observations"
        - "Team tested (2+ developers)"

      governance:
        - "Code reviewed (2+ approvals)"
        - "Added to settings.json enabled list"
        - "Documented in .claude/CLAUDE.md"
        - "Version number assigned"
        - "Team notified"

    benefits:
      for_developers:
        - "Skills trigger when needed (clear descriptions)"
        - "Faster responses (lean SKILL.md)"
        - "Easier maintenance (progressive disclosure)"
        - "Better quality (evaluation-driven development)"

      for_teams:
        - "Shareable skills (clear structure)"
        - "Consistent patterns (consolidated skills)"
        - "Version tracking (semantic versioning)"
        - "Onboarding easier (documented examples)"

      for_claude:
        - "Better matching (specific descriptions)"
        - "Less context (progressive loading)"
        - "Clearer instructions (well-structured)"
        - "Fewer errors (error handling in scripts)"

    prevention:
      - prevention: "Design skills as single-purpose tools with clear scope"
        reason: "Multi-purpose skills confuse Claude, harder to match, less reliable"
        how: "One skill = one responsibility. Split complex skills into multiple focused skills"
      - prevention: "Include progressive disclosure for large skills (>300 lines)"
        reason: "Claude loads entire skill, large skills waste tokens and slow execution"
        how: "Add @references tag: 'Load detailed docs on demand from references/'"
      - prevention: "Test skill invocations with various prompts before integrating"
        reason: "Untested skills may fail in production, frustrate users"
        how: "Test: invoke skill with 5 different prompts, verify correct execution each time"
      - prevention: "Use skill-rules.json for auto-invocation, not manual calling"
        reason: "Auto-invocation faster, more reliable, better user experience"
        how: "Configure trigger conditions in skill-rules.json instead of manual /skill-name"
      - prevention: "Consolidate similar skills instead of creating multiple variations"
        reason: "Too many similar skills confuse matching, increase maintenance burden"
        how: "Merge 3-5 similar skills into one with parameters or sub-commands"
      - prevention: "Document skill inputs, outputs, and side effects explicitly"
        reason: "Claude needs to know what skill does to use it correctly"
        how: "Add to skill description: 'Inputs: file_path. Outputs: validation_report. Side effects: none'"
      - prevention: "Add error handling and validation in skill scripts"
        reason: "Unclear error messages waste time debugging, poor user experience"
        how: "Wrap in try/except, validate inputs, provide actionable error messages"
      - prevention: "Version skills and track breaking changes"
        reason: "Teams need to know when skill API changes, prevents breaking workflows"
        how: "Semantic versioning: MAJOR.MINOR.PATCH, document breaking changes in changelog"
      - prevention: "Share reusable skills across projects via Shared KB"
        reason: "Duplication causes drift, best practices lost in isolated projects"
        how: "Contribute universal skills to Shared KB, import as submodules in projects"
    related_patterns:
      - PROGRESSIVE-DISCLOSURE-001 (Layered information loading)
      - AGENT-TASK-TRACKING-001 (Task management in skills)
      - CLAUDE-CODE-SHARED-MODEL-001 (Shared skill organization)

    references:
      - "Claude Code Skills Documentation"
      - "Claude Skills Guide: tmp/claude-skills-guide.md (1,478 lines)"
      - "Evaluation-Driven Development methodology"

    metadata:
      created_at: "2026-01-07"
      author: "Shared KB Curator"
      source: "Claude Code Skills Guide analysis"
      reusable: true
      severity_level: 2
      difficulty: "intermediate"
      pattern_type: "design"
      applicable_to: ["claude-code", "skills", "documentation", "ai-agents"]
