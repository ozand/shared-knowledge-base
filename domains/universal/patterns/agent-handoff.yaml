# Agent Handoff Pattern: Project Agents ‚Üî Shared KB Curator

version: "1.0"
category: "agent-workflow"
last_updated: "2026-01-06"

patterns:
  - id: "AGENT-HANDOFF-001"
    title: "Cross-Repository Agent Collaboration Pattern"
    severity: "high"
    scope: "universal"
    tags: ["agent", "collaboration", "handoff", "workflow", "github-issues"]

    problem: |
      **Context:** Shared Knowledge Base is used across multiple projects.

      **Scenario:**
      - Project Agent (in project-A) discovers reusable error pattern
      - Pattern should be in Shared KB for all projects to benefit
      - But Project Agent is NOT responsible for maintaining Shared KB
      - Shared KB Curator Agent (in shared-knowledge-base) is responsible

      **Challenge:**
      How do project agents contribute improvements to Shared KB without:
      - Direct write access to shared-knowledge-base repository?
      - Breaking existing validation rules?
      - Creating duplicate entries?
      - Waiting indefinitely for review?

      **Wrong Approach:**
      ‚ùå Project Agent directly commits to shared-knowledge-base
      ‚ùå Project Agent sends email/message to curator
      ‚ùå Pattern is documented only in project-A (not shared)
      ‚ùå Issue created without details, sits in backlog forever

    solution:
      workflow: "@references/AGENT-HANDOFF-001-workflow.md"

    best_practices:

      for_project_agents:
        - item: "Always validate YAML before creating issue"
          reason: "Curator can process faster"

        - item: "Provide complete, tested examples"
          reason: "Reduces curator review time"

        - item: "Include real-world context"
          reason: "Helps curator understand applicability"

        - item: "Suggest appropriate scope"
          reason: "Shows you've considered the placement"

        - item: "Check for duplicates first"
          reason: "Prevents redundant entries"

        - item: "Use descriptive titles"
          reason: "Improves discoverability"

      for_curator_agents:
        - item: "Review issues within 24 hours"
          reason: "Maintains contributor motivation"

        - item: "Validate all entries before merging"
          reason: "Maintains KB quality"

        - item: "Enhance entries, don't just copy"
          reason: "Adds value beyond contribution"

        - item: "Close issues with clear feedback"
          reason: "Confirms to contributor it was merged"

        - item: "Thank contributors"
          reason: "Encourages future contributions"

        - item: "Monitor for duplicate issues"
          reason: "Link related issues, avoid redundancy"

    communication_templates:

      project_agent_to_curator:
        title_template: "Add {CATEGORY}-{NNN}: {Descriptive Title}"

        labels:
          - "kb-improvement"
          - "enhancement"  # or "bug", "yaml-error"
          - "{language/framework}"

        body_sections:
          - "## Proposed KB Entry"
          - "## Validation Result"
          - "## Real-World Example"
          - "## Benefit to Community"
          - "## Suggested Scope"
          - "## Additional Context"

      curator_to_contributor:
        merged:
          greeting: "‚úÖ **Merged to main!**"
          sections:
            - "Location: {file_path}"
            - "Entry ID: {entry_id}"
            - "Validation: ‚úì Passed"
            - "Available in: {version}"
            - "Changes made: {list}"
            - "Thank you for your contribution!"

        needs_work:
          greeting: "üìù **Needs additional work**"
          sections:
            - "Issues found: {list}"
            - "Requested changes: {list}"
            - "Please update and we'll review again"
            - "Questions? Comment below"

        rejected:
          greeting: "‚ùå **Not suitable for Shared KB**"
          sections:
            - "Reason: {why not suitable}"
            - "Suggestion: {alternative}"
            - "Consider: {options}"

    example_workflow:

      scenario_1_new_error_pattern:
        title: "Python Async Timeout Error"
        project: "E-commerce Backend"

        steps: |
          **Project Agent:**
          1. Encounters asyncio.TimeoutError in production
          2. Searches KB: kb search "asyncio timeout"
          3. Not found
          4. Implements solution with timeout handling
          5. Determines: "Reusable for any async Python code"
          6. Creates YAML: python/errors/async-timeout.yaml
          7. Validates: ‚úì Passed
          8. Creates GitHub issue #15

          **Curator Agent (24h later):**
          1. Reviews issue #15
          2. Validates YAML: ‚úì Passed
          3. Checks for duplicates: None found
          4. Enhances: Adds more examples, prevention tips
          5. Commits: python/errors/async-timeout.yaml
          6. Closes issue #15 with "Merged!"

          **Project Agent:**
          1. Receives closure notification
          2. Pulls updates: git pull origin main
          3. Searches: kb search "async timeout"
          4. Finds contributed entry
          5. Benefits: All future projects can use this pattern

      scenario_2_yaml_error_fix:
        title: "YAML Syntax Error in postgresql/errors.yaml"
        project: "Data Analytics Platform"

        steps: |
          **Project Agent:**
          1. Trying to initialize KB metadata
          2. Gets error: "Invalid YAML at line 410"
          3. Investigates: postgresql/errors.yaml:410
          4. Finds: mapping value with colon not quoted
          5. Fixes: Changes to single quotes
          6. Validates: ‚úì Passed
          7. Creates GitHub issue #16 with label "yaml-error"

          **Curator Agent:**
          1. Reviews issue #16 (high priority label)
          2. Validates fix: ‚úì Correct
          3. Commits fix directly (simple fix)
          4. Closes issue #16

          **Result:** KB metadata initialization works for everyone

    quality_assurance: "@references/AGENT-HANDOFF-001-quality-assurance.md"

    example_workflow: "@references/AGENT-HANDOFF-001-quality-assurance.md"

    common_submission_failures: "@references/AGENT-HANDOFF-001-quality-assurance.md"

    references:
      - title: "Agent Workflow Pattern"
        url: "https://github.com/ozand/shared-knowledge-base/blob/main/universal/patterns/agent-kb-workflow.yaml"
      - title: "GitHub Issues API"
        url: "https://docs.github.com/en/rest/issues/issues"
      - title: "Shared KB Integration Guide"
        url: "https://github.com/ozand/shared-knowledge-base/blob/main/README_INTEGRATION.md"
      - title: "Quality Standards"
        url: "https://github.com/ozand/shared-knowledge-base/blob/main/curator/QUALITY_STANDARDS.md"
