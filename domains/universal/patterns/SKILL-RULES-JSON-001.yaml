version: '1.0'
category: claude-code
last_updated: '2026-01-07'
patterns:
- id: SKILL-RULES-JSON-001
  title: skill-rules.json Schema and Configuration
  severity: high
  scope: universal
  problem: 'Claude Code skills need a way to define auto-activation triggers,

    but there''s no standard format for configuring:

    - When skills should activate

    - How to match user intent

    - Priority ranking for suggestions

    - File-based triggers

    - Context requirements


    Without a standard schema, auto-activation is inconsistent and

    difficult to maintain across projects.

    '
  symptoms:
  - Skills don't activate consistently
  - No clear way to configure triggers
  - Priority conflicts between skills
  - Missing file-based activation
  - Inconsistent skill suggestions
  root_cause: 'Claude Code has a hook system (UserPromptSubmit) for skill

    activation but lacks a standardized schema for defining skill

    trigger rules and priorities.

    '
  solution:
    code: "# .claude/skill-rules.json - Complete schema\n\n{\n  \"skill-name\": {\n\
      \    # Required: Skill type\n    \"type\": \"domain|technical|workflow|utility\"\
      ,\n\n    # Optional: Enforcement level\n    \"enforcement\": \"suggest|require|optional\"\
      ,\n\n    # Required: Priority level\n    \"priority\": \"critical|high|medium|low\"\
      ,\n\n    # Required: Brief description\n    \"description\": \"Brief description\
      \ (1-2 sentences)\",\n\n    # Required: Trigger configuration\n    \"promptTriggers\"\
      : {\n      # Simple word matching (5-10 keywords)\n      \"keywords\": [\"keyword1\"\
      , \"keyword2\", \"keyword3\"],\n\n      # Optional: Regex patterns for intent\
      \ (2-5 patterns)\n      \"intentPatterns\": [\n        \"(create|add|implement).*?pattern\"\
      ,\n        \"pattern.*?(alternative|variation)\"\n      ],\n\n      # Optional:\
      \ File-based triggers\n      \"fileTriggers\": {\n        # Glob patterns for\
      \ file paths\n        \"pathPatterns\": [\"**/*.py\", \"src/**/*.ts\"],\n\n\
      \        # Regex patterns for file content\n        \"contentPatterns\": [\"\
      import asyncio\", \"useState\"]\n      }\n    },\n\n    # Optional: Context\
      \ and dependencies\n    \"context\": {\n      # Required skills\n      \"requires\"\
      : [\"other-skill\"],\n\n      # Conflicting skills\n      \"incompatibleWith\"\
      : [\"conflicting-skill\"],\n\n      # File types this applies to\n      \"fileTypes\"\
      : [\"*.py\", \"*.ts\"],\n\n      # Programming languages\n      \"languages\"\
      : [\"python\", \"typescript\"]\n    },\n\n    # Optional: Activation behavior\n\
      \    \"activation\": {\n      # Auto-load without confirmation\n      \"autoLoad\"\
      : false,\n\n      # Require user confirmation\n      \"userConfirmation\": true,\n\
      \n      # Priority score boost\n      \"priorityBoost\": 0\n    }\n  }\n}\n\n\
      # Priority scoring algorithm\nBase priority:\n  critical = 100\n  high = 75\n\
      \  medium = 50\n  low = 25\n\n+ Keyword match: +10 each\n+ Intent pattern match:\
      \ +20 each\n+ File path match: +15 each\n+ File content match: +15 each\n+ Priority\
      \ boost: +activation.priorityBoost\n\n= Total score\n\n# Example: Python async\
      \ skill\n{\n  \"python-async\": {\n    \"type\": \"technical\",\n    \"priority\"\
      : \"high\",  # Base: 75\n    \"description\": \"Python async/await patterns\
      \ and coroutines\",\n    \"promptTriggers\": {\n      \"keywords\": [\"python\"\
      , \"async\", \"await\", \"coroutine\"],  # +40 if all match\n      \"intentPatterns\"\
      : [\n        \"(create|add).*?python.*?(async|coroutine)\"  # +20 if matches\n\
      \      ],\n      \"fileTriggers\": {\n        \"pathPatterns\": [\"**/*.py\"\
      ],  # +15 if match\n        \"contentPatterns\": [\"import asyncio\", \"async\
      \ def\"]  # +15 if match\n      }\n    },\n    \"activation\": {\n      \"priorityBoost\"\
      : 5  # +5\n    }\n  }\n}\n\n# Scenario: User asks \"Create async function in\
      \ python\" with api.py open\n# Score: 75 (base) + 20 (keywords) + 20 (intent)\
      \ + 15 (path) + 15 (content) + 5 (boost) = 150\n# Result: Skill suggested with\
      \ high confidence\n"
    explanation: "The skill-rules.json schema provides a standardized way to configure\n\
      auto-activation for Claude Code skills.\n\n**Key components:**\n\n1. **type**\
      \ - Categorizes the skill\n   - domain: Language/framework skills (python, docker)\n\
      \   - technical: Specific techniques (async, testing)\n   - workflow: Process\
      \ skills (git-workflow, code-review)\n   - utility: Helper skills (kb-search,\
      \ formatting)\n\n2. **priority** - Controls suggestion order\n   - critical:\
      \ Always suggest (100 points)\n   - high: Strongly suggest (75 points)\n   -\
      \ medium: Suggest when relevant (50 points)\n   - low: Only if highly relevant\
      \ (25 points)\n\n3. **promptTriggers** - How to match user prompts\n   - keywords:\
      \ Simple case-insensitive word matching\n   - intentPatterns: Regex for complex\
      \ intent matching\n   - fileTriggers: File path and content patterns\n\n4. **scoring**\
      \ - Calculate relevance\n   - Base priority + matches + boost\n   - Skills with\
      \ score >50 are suggested\n   - Top 3 skills shown to user\n\n**Benefits:**\n\
      - Standardized configuration format\n- Consistent auto-activation behavior\n\
      - Priority-based skill ranking\n- File-based context awareness\n- Easy to maintain\
      \ and extend\n"
  examples:
  - name: Domain skill with file triggers
    description: Python development skill activates when working with Python files
    code: "{\n  \"python-development\": {\n    \"type\": \"domain\",\n    \"priority\"\
      : \"high\",\n    \"description\": \"Python development patterns and best practices\"\
      ,\n    \"promptTriggers\": {\n      \"keywords\": [\"python\", \"py\", \"django\"\
      , \"flask\"],\n      \"fileTriggers\": {\n        \"pathPatterns\": [\"**/*.py\"\
      ],\n        \"contentPatterns\": [\"import \", \"from \", \"#!/usr/bin/env python\"\
      ]\n      }\n    }\n  }\n}\n"
  - name: Technical skill with intent patterns
    description: Async programming skill activates for async-related requests
    code: "{\n  \"async-programming\": {\n    \"type\": \"technical\",\n    \"priority\"\
      : \"medium\",\n    \"description\": \"Async/await patterns and coroutines\"\
      ,\n    \"promptTriggers\": {\n      \"keywords\": [\"async\", \"await\", \"\
      coroutine\"],\n      \"intentPatterns\": [\n        \"(create|make).*?async.*?(function|method)\"\
      ,\n        \"how.*(use|implement).*?(async|await)\"\n      ]\n    }\n  }\n}\n"
  - name: Workflow skill
    description: Git workflow skill for commit and branch operations
    code: "{\n  \"git-workflow\": {\n    \"type\": \"workflow\",\n    \"priority\"\
      : \"high\",\n    \"description\": \"Git workflow conventions and best practices\"\
      ,\n    \"promptTriggers\": {\n      \"keywords\": [\"git\", \"commit\", \"branch\"\
      , \"merge\"],\n      \"intentPatterns\": [\n        \"(commit|push|merge).*?changes\"\
      ,\n        \"create.*?(branch|tag)\"\n      ]\n    }\n  }\n}\n"
  benefits:
  - Standardized auto-activation configuration
  - Priority-based skill suggestions
  - File-based context awareness
  - Flexible trigger patterns
  - Easy to maintain and extend
  prevention:
  - Always validate JSON syntax (jq . skill-rules.json)
  - Match skill name exactly in skill-rules.json and YAML frontmatter
  - Use 5-10 specific keywords per skill
  - Test intent patterns with regex101.com before using
  - Set appropriate priority (not everything high/critical)
  - Test file triggers with actual project files
  - Register UserPromptSubmit hook in settings.json
  - Restart Claude Code after modifying skill-rules.json
  tags:
  - claude-code
  - skills
  - skill-rules
  - json
  - schema
  - auto-activation
  related_patterns:
  - CLAUDE-CODE-AUTO-ACTIVATION-001
  - HOOK-PATTERNS-001
  - MODULAR-SKILLS-001
  domains:
    primary: api
    secondary: []
