# Shared Knowledge Base (UKB) - Agent Guidelines

This document provides guidelines for AI agents working on the Universal Shared Knowledge Base (UKB) repository.

## 1. Project Philosophy & Architecture

**IMPORTANT**: This repository acts as the **Central Hub (Source)**.
It is NOT just a standalone tool, but a distribution center for engineering knowledge.

*   **The Hub (This Repo)**: Stores canonical knowledge (YAML), capabilities (agents/skills), and core management tools.
*   **The Clients (Target Projects)**: Developers "install" portions of this base into their projects. They do not clone the whole repo, but sync specific **Domains** (e.g., `python`, `docker`) via `tools/kb.py`.

### Core Components
1.  **Knowledge Content** (`domains/`): The actual data (errors, patterns, guidelines).
2.  **Capabilities** (`agents/`, `.claude/`): Reusable agent personas and skills meant to be exported.
3.  **Core Tools** (`tools/`): The engine that manages validation, indexing, and synchronization/installation logic.

## 2. Key Directories

- `tools/`: **Core Logic** (CLI, validation, search, sync).
  - `kb.py`: Unified Entry Point.
  - `core/`: Shared utilities.
- `domains/`: **Knowledge Data** organized by technology (e.g., `domains/python/*.yaml`).
- `agents/`: **Agent Personas** for distribution.
- `tests/`: Pytest suite for the *Core Tools*.
- `docs/`: Integration documentation.

## 3. Build & Maintenance Commands

The "build" process here effectively means **Validation** and **Indexing**.

### Primary Workflow
*   **Validate Content** (ALWAYS run after editing YAML):
    ```bash
    python tools/kb.py validate domains/     # Validate all
    python tools/kb.py validate domains/python/ # Validate specific domain
    ```

*   **Rebuild Search Index** (Run after adding/removing content):
    ```bash
    python tools/kb.py index --force
    ```

*   **Verify Retrieval** (Ensure your changes are searchable):
    ```bash
    python tools/kb.py search "your new term"
    ```

### Testing Core Tools
If you modify scripts in `tools/`:
*   **Run All Tests**: `pytest`
*   **Specific Test**: `pytest tests/test_domain_index_validation.py`

## 4. Code & Content Guidelines

### Python Code (Tools)
*   **Style**: PEP 8, 4 spaces indentation.
*   **Types**: Strict typing required (`from typing import ...`).
*   **Docstrings**: Google-style docstrings for all functions.
*   **Paths**: Use `pathlib.Path`. Never hardcode absolute paths; resolve relative to `repo_root`.

### YAML Content (Knowledge)
*   **Schema**: Must adhere to the schema defined in `tools/core/validation.py`.
*   **Structure**:
    *   `errors`: Known issues and fixes.
    *   `patterns`: Best practices and code snippets.
*   **Modularity**: Content must be scoped correctly (e.g., don't put Python errors in the Docker domain).

## 5. Development Workflow for Agents

1.  **Identify Scope**:
    *   Are you fixing the **Core** (tools/scripts)? -> Focus on `tools/` and `tests/`.
    *   Are you adding **Knowledge**? -> Focus on `domains/`.
    *   Are you adding a **Capability**? -> Check `agents/` or `tools/kb_capability.py`.

2.  **Implement**:
    *   Maintain backwards compatibility (old clients might sync this repo).
    *   Respect existing conventions in `domains/`.

3.  **Verify**:
    *   Code: `pytest`
    *   Content: `python tools/kb.py validate <path>`
    *   Index: `python tools/kb.py index`

## 6. Known Constraints

*   **Dependencies**: `PyYAML` and `pytest` are the only heavy dependencies. Keep it lightweight.
*   **Cross-Platform**: Tools must work on Windows/Linux/macOS.
*   **Client Agnostic**: Content should be helpful regardless of the user's specific project structure (unless scoped to a specific framework).

---
*Generated by Agentic Assistant*
